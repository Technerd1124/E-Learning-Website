<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login to Tech And Teach</title>
    <link rel="stylesheet" href="login.css" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.14.4/dist/sweetalert2.all.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/sweetalert2@11.14.4/dist/sweetalert2.min.css"
    />
  </head>
  <body>
    <button onclick="show()">Show Sweet Alert</button>
    <button onclick="showError()">Show Error Alert</button>

    <div class="heading" style="text-align: center">Log Into Tech & Teach</div>
    <div class="formbody">
      <form name="loginform" onsubmit="return validForm()" >
        <h3 style="text-align: center">Login Here</h3>
        <div class="formbox">
          <label>User Name</label>
          <input type="text" name="username" />
        </div>
        <div class="formbox">
          <label>Email</label>
          <input type="email" name="mail" />
        </div>
        <div class="formbox">
          <label>Phone Number</label>
          <input type="tel" name="phoneno" />
        </div>
        <button type="submit">Submit</button>
      </form>
    </div>

    <!-- ---------- Script -------------- -->
    <script>
      function show() {
        Swal.fire({
          position: "center",
          icon: "success",
          title: "You are Logged In",
          showConfirmButton: true,
        });
      }

      function showError() {
        Swal.fire({
          position: "center",
          icon: "error",
          title: "Invalid Username",
          text: "Username must be between 4 and 15 characters.",
          showConfirmButton: true,
        });
      }

      function validateUser(username) {
        const validUsernameRegex =
          /^(?![!@#$%^&*()_+={}\[\]:;"'<>,.?/~`\\|-])[a-zA-Z][a-zA-Z0-9_-]{3,14}$/;
        return username !== "" && validUsernameRegex.test(username);
      }

      function validatePhone(phoneVal) {
        const regex = /^\d{10}$/; // For exact 10 digits only
        return phoneVal !== "" && regex.test(phoneVal);
      }

      function validateEmail(emailVal) {
        const regex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
        return emailVal !== "" && regex.test(emailVal);
      }

      function validForm() {
        const user = document.forms[0].username.value;
        const mail = document.forms[0].mail.value;
        const phone = document.forms[0].phoneno.value;

        if (!validateUser(user)) {
          Swal.fire({
            icon: "error",
            title: "Invalid Username",
            text: "Username must be between 4 and 15 characters & start with an alphabet.",
            showConfirmButton: true,
          });
          return false;
        }

        if (!validateEmail(mail)) {
          Swal.fire({
            icon: "error",
            title: "Invalid Email",
            text: "Please enter a valid email address.",
            showConfirmButton: true,
          });
          return false;
        }

        if (!validatePhone(phone)) {
          Swal.fire({
            icon: "error",
            title: "Invalid Phone Number",
            text: "Phone number must be exactly 10 digits.",
            showConfirmButton: true,
          });
          return false;
        }

        setCookie();
       
        return true;
      }

      function setCookie() {
        const form = document.forms.loginform;
        const date = new Date();
        date.setMonth(date.getMonth() + 1);

        document.cookie = `UserName=${
          form.username.value
        }; expires=${date.toUTCString()}; path=/`;
        document.cookie = `MailID=${
          form.mail.value
        }; expires=${date.toUTCString()}; path=/`;
        document.cookie = `PhoneNumber=${
          form.phoneno.value
        }; expires=${date.toUTCString()}; path=/`;

        Swal.fire({
          position: "center",
          icon: "success",
          title: "You're Logged In Successfully",
          showConfirmButton: true,
        }).then((result) => {
          if (result.isConfirmed) {
            // Redirect to index.html after the user confirms the alert
            window.location.href = "index.html";
          }
        });
      }
    </script>
  </body>
</html>
